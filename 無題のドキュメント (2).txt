子ども向け検索サイト「こどもけんさく」仕様書（アップデート版：すごろく連動学習機能付き）
________________


アプリ概要
子どもが知りたいことを、やさしい言葉で、安全に検索できるAI検索プラットフォーム。検索結果は、地域の商店主＝「先生」につながり、リアルな学びへと発展する。さらに、チャットと連動した「すごろくゲーム」によって、楽しく学びながら達成感を得られる構成。
________________


Supabase情報
* プロジェクトURL：https://sgqocipbrjvribupcoxp.supabase.co

anonキー：

eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNncW9jaXBicmp2cmlidXBjb3hwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM5NzI2MjUsImV4cCI6MjA2OTU0ODYyNX0.SuDLRiF3tGwnXxJKjxa3xmhxtK7dCYM-V19mQAzmDdQ
   * ________________


API構成（GPT-4o使用）
本アプリのすべてのAPI処理は Supabase Edge Functions により提供され、AI応答には GPT-4o モデルを使用する。エッジ関数は以下のように機能を分担：
関数名
	概要
	generate-ai-response
	子どもの質問を受け取り、AIからやさしい説明＋クイズ生成を行う
	verify-quiz-answer
	クイズの解答を受け取り、正誤判定とポイント進行を返す
	get-sugoroku-status
	現在のすごろく状態（マス数・進捗・ゴール）を返す
	complete-sugoroku
	ゴール到達時に知識カードと商店主情報を返す
	log-visit
	実店舗を訪れたログをMyノートに追加する
	________________


ユーザー概要
分類
	内容
	子供
	知りたいことを、やさしく教えてほしい + 遊びながら学びたい
	保護者
	安全に使わせたい / 学習履歴を知りたい
	教育者
	推奨学習に利用したい
	商店主
	地域教育に貢献しつつ、店舗に来てもらいたい（負担なし）
	________________


メイン機能構成
1. AI検索＆やさしい説明チャット
   * 子どもの言葉を整形し、やさしい言葉で説明

   * 各トピックに対して1問以上の理解クイズを自動出題

2. すごろく学習ゲーム（チャット連動）
      * チャット横に常時表示（テーマ別すごろく）

      * 正解：1マス進む、不正解：1マス戻る（最小0）

      * ゴールで「知識カード」＋「商店主先生」紹介

      * 各テーマ10マス、次テーマはロック解除制

3. 商店主先生の紹介（来店誘導）
         * ゴール時、関連テーマの商店主先生を紹介

         * 「お店に行ってみよう」ボタン表示

         * 質問や応答はすべてAIが代行、商店主の負担ゼロ

4. Myノート（学びと実体験の記録）
            * 調べた内容、チャット、カード、得点、訪問記録を自動保存

            * 学習図鑑風に「集めた知識カード」「商店訪問バッジ」なども表示

________________


子ども向けUI（チャット＋すごろく）
+---------------------------+-----------------------+
|     🧠 チャット欄         |  🎲 まなびすごろく       |
|---------------------------|-----------------------|
| 子：パンってどうして…？   |  🌱 1 2 3 4 5 6 7 8 9🏁 |
| AI：いい質問だね…         | 😺← ← ← ← ← ← ← ← ← |
| AI：クイズ！ パンを        | 🎉 正解！→1マス進んだよ！ |
| ふくらませるのは？        |                       |


________________


商店主先生 登録UI（負担ゼロ）
項目
	内容
	お店名
	例：うちだパン店
	店主名
	うちだ たかし（写真付き）
	教えられるテーマ
	パン作り、発酵、粉の違いなど
	来店方式
	見学可／体験可（予約制）など指定可
	応対
	不要。すべてAIが代行。実体験のみ提供
	________________


データベース構造（Supabase）
search_logs（検索履歴）
項目
	型
	説明
	id
	uuid
	PK
	user_id
	uuid
	ユーザー識別
	query
	text
	質問内容
	result_summary
	text
	AI回答要約
	created_at
	timestamp
	

	teachers（商店主先生）
| id | uuid |
| name | text |
| shop_name | text |
| specialty | text |
| location | text |
| profile_img_url | text |
| visit_type | text | 例：予約制、自由見学など |
messages（チャット履歴）
| id | uuid |
| user_id | uuid |
| teacher_id | uuid（NULL可）|
| message | text |
| answer | text |
| created_at | timestamp |
mynotes（学習ノート）
| id | uuid |
| user_id | uuid |
| entry_title | text |
| summary | text |
| knowledge_card | text[] |
| shop_visit_log | json |
| created_at | timestamp |
sugoroku_progress（すごろく進行）
| id | uuid |
| user_id | uuid |
| theme | text |
| current_position | int (0〜10) |
| started_at | timestamp |
| finished | boolean |
________________


ごほうびと連動機能
               * ゴール後：商店主先生の紹介カード表示＋「お店へ行こう」導線

               * ごほうび：「知識カード」付与、次テーマ解放、学習図鑑追加

               * 訪問後：Myノートに「行った記録」「写真」「感想」保存

________________


まとめ
このアップデート版「こどもけんさく」は、
                  * チャット × すごろくで楽しく学び

                  * 学びの結果が“地域のお店”につながる

                  * 商店主に負担をかけずに地域教育を実現できる
次世代型「学び × 地域 × ゲーム」アプリである。